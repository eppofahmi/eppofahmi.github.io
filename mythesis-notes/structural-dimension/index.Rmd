---
title: "Dimensi Struktural Ruang publik"
author: "Ujang Fahmi"
date: "4/11/2018"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
    includes:
      after_body: footer.Rhtml
  word_document:
    toc: yes
    toc_depth: '3'
---

<style>
p.caption {
  font-size: 0.9em;
  font-style: italic;
  color: grey;
  margin-right: 10%;
  margin-left: 10%;  
  text-align: central;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```

# Pendahuluan
Halaman ini merupakan catatan penelitian tentang keberadaan ruang publik di balik sebuah tagar yang digunakan di media sosial. Keberadaan ruang publik di sini diidentifikasi melalui tiga dimensi ruang publik, yaitu: (1) dimensi struktural; (2) dimensi representasional; dan (3) dimensi interaksional. Identifikasi terhadap tiga dimensi tersebut dibagi menjadi di folder. Bagian ini akan berusahan mengidentifikasi, menjelaskan, dan memaknai berbagai aktivitas warga net di Twitter terkait dengan keberadaan tagar #jogjaoradidol di twitter. Berikut adalah pertanyaan yang mencoba dijawab: 

  > Bagaimana keterlibatan masyarakat dalam penggunaan tagar #jogjaoradidol di Twitter?

Untuk menjawab pertanyaan tersebut, tiga indikator dimensi struktural ruang publik, yaitu: (1) inklusif ada kesempatan yang sama untuk terlibat dalam diskuis; (2) bebas dari kepentingan kekuasaan dan ekonomi; dan (3) memungkinkan terbentuknya opini publik. 

Pembahasan dibagi menjadi beberapa bagian. Pertama, membahas berbagai aktivitas warga net di dalam Twitter. Kedua, membahas berbagai kejadian di dunia nyata yang melatari penggunaan tagar. Ketiga, membahas makna keberadaan tagar sebagai sebuah ruang yang dapat dijadikan tempat untuk mendiskusikan kebijakan.

# Persiapan

## R Library
```{r}
library(lubridate)
library(tidyverse)
library(tidytext)
library(stringr)
library(lubridate)
library(tm)
library(reshape2)
library(scales)
```

Di sini saya akan terlebih dahulu mempersiapkan file yang ingin dianalisis. Persiapan meliputi membuat semua variable dalam format yang tepat, hingga menambah variabel baru berdasarkan data yang ada. 

Variabel yang ingin ditambahkan adalah:
1. Identitas logical twit sebagai duplicate atau bukan
2. Username dan count username
3. Membagi data menjadi beberapa kluster berdasarkan tanggal posting
4. Menambah kolom untuk teks yang sudah dibersihkan
5. Menambah kolom jumlah term per row dari teks yang sudah diberishkan
6. Mengekstrak tagar tiap row
7. Menghitung jumlah tagar per baris. 

Saat ini, data sudah memiliki 10 kolom, oleh dengan rencana diatas maka data akan memiliki 17 kolom. 

```{r}
# import data
raw_jod <- read.csv("hasil-new1.csv", stringsAsFactors = FALSE, header = FALSE, sep = ",")
nama_kolom1 <- c("date", "time", "username", "tweets", "replying", "rep_count", "ret_count", "fav_count", "link")
colnames(raw_jod) <- nama_kolom1

# transform date format
raw_jod$date <- as.Date(raw_jod$date, format = "%Y/%m/%d")

#raw_jod$time <- hms(raw_jod$time, roll = FALSE, quiet = FALSE)
# tranform NA to 0 in fav_count, rep_count, and ret_count
raw_jod$ret_count <- as.integer(raw_jod$ret_count)
raw_jod <- tidyr::replace_na(raw_jod, list(fav_count=0, rep_count=0, ret_count=0))
```

## Duplicate or Not

```{r}
raw_jod <- raw_jod %>%
  dplyr::mutate(is_duplicate = duplicated(tweets))
jod_dup <- raw_jod %>%
  filter(is_duplicate == TRUE)
jod_no_dup <- raw_jod %>%
  filter(is_duplicate == FALSE)
```

Jumlah total twit = 13493

Jumlah twit yang memiliki duplicte = 866

Jumlah twit yang tidak memiliki duplicte = 12627

## Pembagian periode
Untuk melihat perkembangan penggunaan tagar, twit dibagi menjadi beberapa periode berdasarkan tahapan perkembangan sebuah gerakan sosial. Salah satu referensi dapat dilihat [di sini.](https://www.ebscohost.com/uploads/imported/thisTopic-dbTopic-1248.pdf)

1. Fase Emergence: 2013-10-07 sampai 2013-12-31
2. Fase Coalescence: 2014-01-01 sampai 2014-06-30
3. Fase Bureaucratization: 2014-07-01 sampai 2014-12-31
4. Fase Decline: 2015-01-01 sampai 2017-08-30

```{r}
fase1 <- raw_jod %>% 
  subset(date >= "2013-10-07" & date <= "2013-12-31" ) %>%
  mutate(fase = "1_Emergence")

fase2 <- raw_jod %>% 
  subset(date >= "2014-01-01" & date <= "2014-10-31" ) %>%
  mutate(fase = "2_Coalescence")

fase3 <- raw_jod %>% 
  subset(date >= "2014-11-01" & date <= "2015-10-31" ) %>%
  mutate(fase = "3_Bureaucratization")

fase4 <- raw_jod %>% 
  subset(date >= "2015-11-01" & date <= "2017-08-31" ) %>%
  mutate(fase = "4_Decline")

raw_jod <- bind_rows(fase1, fase2, fase3, fase4)
```

**Catatan:** Ada satu row yang hilang, padahal parameter tanggal sudah sesuai dengan rentang waktu. Kemungkinannya, ada salah satu row di kolom `date` yang kosong. Untuk selanjutnya, jumlah twit yang akan dianalisis sebanya **13492**.

## Username 
Script berikut ini membuat dua buah kolom yang berisi daftar username yang diambil dari kolom username dan tweets. Kolom lainnya merupakan jumlah username per baris yang menunjukkan jumlah username yang terlibat dalam sebuah twit. 

```{r}
# menambah @ pada kolom username
raw_jod$username <- paste("@", raw_jod$username, sep="")

# menggabungkan kolom username dengan tweet
raw_jod$user_all <- paste(raw_jod$username, raw_jod$tweets, sep=" ")

# mengekstrak username dari kolom hasil gabungan di atas 
raw_jod$user_all <- sapply(str_extract_all(raw_jod$user_all, "@\\S+", simplify = FALSE), paste, collapse=" ")

# merenggangkan tanda : setelah username 
raw_jod$user_all <- gsub(":", " \\1 ", raw_jod$user_all, perl=T)

raw_jod$user_count <- sapply(raw_jod$user_all, function(x) length(unlist(strsplit(as.character(x), "@\\S+"))))
```

## Tweets cleaning
Script berikut ini digunakan untuk membuat kolom twit yang sudah dibersihkan dari:

1. Username
2. Tagar
3. Urls 
4. Stopwords bahasa Indonesia
5. Term yang dipilih untuk dihilangkan, yaitu term yang tidak dapat diartikan atau kurang relevan dalam upaya mejawab pertanyaan penelitian. 

Selain itu, script di bawah ini juga membuat kolom baru yang berisi jumlah term per kolom. Kolom baru ini selanjutnya akan digunakan sebagai parameter utama untuk membuat data input untuk lDA. 

```{r, echo=FALSE}
# fungsi untuk cleaning 
tweet_cleaner <- function(input_text) # nama kolom yang akan dibersihkan
{    
  # create a corpus (type of object expected by tm) and document term matrix
  corpusku <- Corpus(VectorSource(input_text)) # make a corpus object
  # remove urls1
  removeURL1 <- function(x) gsub("http[^[:space:]]*", "", x) 
  corpusku <- tm_map(corpusku, content_transformer(removeURL1))
  #remove urls3
  removeURL2 <- function(x) gsub("pic[^[:space:]]*", "", x) 
  corpusku <- tm_map(corpusku, content_transformer(removeURL2))
  #remove username 
  TrimUsers <- function(x) {
    str_replace_all(x, '(@[[:alnum:]_]*)', '')
  }
  corpusku <- tm_map(corpusku, TrimUsers)
  #remove all "#Hashtag1"
  removehashtag <- function(x) gsub("#\\w+", "", x)
  corpusku <- tm_map(corpusku, content_transformer(removehashtag))
  #merenggangkan tanda baca
  tandabaca1 <- function(x) gsub("((?:\b| )?([.,:;!?()]+)(?: |\b)?)", " \\1 ", x, perl=T)
  corpusku <- tm_map(corpusku, content_transformer(tandabaca1))
  #remove puntuation
  removeNumPunct <- function(x) gsub("[^[:alpha:][:space:]]*", "", x) # kecuali - dan '
  corpusku <- tm_map(corpusku, content_transformer(removeNumPunct))
  corpusku <- tm_map(corpusku, stripWhitespace)
  corpusku <- tm_map(corpusku, content_transformer(tolower)) 
  #stopwords bahasa indonesia
  stopwords <- read.csv("stopwords_indo.csv", header = FALSE)
  stopwords <- as.character(stopwords$V1)
  stopwords <- c(stopwords, stopwords())
  corpusku <- tm_map(corpusku, removeWords, stopwords)
  #kata khusus yang dihapus
  corpusku <- tm_map(corpusku, removeWords, c("rt", "ini", "jogja", "jogjaoradidol", "via","yg", "tdk", "=", "ngundang", "jogja", "ora", "didol", "yo", "ya", "ra", "aaaa", "yogyakarta", "oke", "hape", "dg", "sms", "order", "tees", "k", "jan", "tau", "min", "selamat", "pagi", "idr", "dp", "utk", "mas", "byk", "krn", "adl", "sbg", "dr", "td", "dlm", "jd", "ovj", "yogya", "vers", "cc", "aaaaakkk", "iki", "hhaha", "v", "d", "oi", "yossiku", "hahaha", "sep", "y", "p", "suuuuuu", "ah", "n", "s", "d", "e", "xrzlx", "iyaa", "loh", "cont", "si", "wkwk", "hehe", "l", "sy", "eciyeee", "nahh", "asoooyyyyyy", "xxxxxxx", "ih", "lik", "hahahaha", "yoezznart", "kae", "o", "bzzzzzzzzzzzzz", "hahha", "eaaaaah", "eaaah", "hmm", "uwiiiihhh", "nahh", "yk", "j", "g", "ooopppssss", "yosuaapratama", "wkwkkkk", "b", "t"))
  corpusku <- tm_map(corpusku, stripWhitespace)
  #removing white space in the begining
  rem_spc_front <- function(x) gsub("^[[:space:]]+", "", x)
  corpusku <- tm_map(corpusku, content_transformer(rem_spc_front))

  #removing white space at the end
  rem_spc_back <- function(x) gsub("[[:space:]]+$", "", x)
  corpusku <- tm_map(corpusku, content_transformer(rem_spc_back))
  data <- data.frame(clean_text=sapply(corpusku, identity),stringsAsFactors=F)
}
```

Menjalankan fungsi cleaner pada kolom `tweets`

```{r}
jod_clean <- tweet_cleaner(raw_jod$tweets)
jod_clean$word_count <- sapply(jod_clean$clean_text, function(x) length(unlist(strsplit(as.character(x), "\\W+"))))
```

Menggabungkan hasil cleaning dengan data awal

```{r}
raw_jod <- bind_cols(raw_jod, jod_clean)
# zzzzzz clean environment
rm(jod_clean)
```


## Hashtag per row

```{r}
# mengekstrak username dari kolom hasil gabungan di atas 
raw_jod$hashtag <- sapply(str_extract_all(raw_jod$tweets, "#\\S+", simplify = FALSE), paste, collapse=" ")

# merenggangkan tanda : setelah username 
#raw_jod$user_all <- gsub(":", " \\1 ", raw_jod$user_all, perl=T)

raw_jod$tag_count <- sapply(raw_jod$hashtag, function(x) length(unlist(strsplit(as.character(x), "@\\S+"))))
```

***

# Analisis
Untuk mendapatkan tilikan, saya coba petakan terlebih dahulu tagar-tagar yang digunakan dalam twit dan melihat 10 tagar dengan frekuensi tertinggi berkembang dalam setiap fase gerakan. 

**tagar**
```{r tagar, fig.cap="Figure 1: Tagar paling sering digunakan", fig.align='center'}
tagar <- raw_jod %>%
  group_by(fase) %>%
  unnest_tokens(hashtag, hashtag, to_lower = FALSE) %>%
  count(hashtag, sort = TRUE) %>%
  arrange(desc(n)) %>%
  ungroup()

# viz
tagar %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(x = reorder(hashtag, n), y = n, fill = factor(fase))) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  facet_wrap(~fase) +
  labs(x = "Tagar", 
       y = "Frekuensi")
```

1. Pada fase pertama, pada prinsipnya hanya satu tagar yang paling sering digunakan, yaitu tagar #jogjaoradidol. 
2. Pada fase kedua, hal yang dibicarakan oleh warga net dalam twit dengan tagar #jogjaoradidol mulai berkembang. Hal ini ditandai dengan munculya tagar #balitolakreklamasi, #jogja, dan 10thjhf. Tiga tagar tersebut mengindikasikan mulai berkembangnya pembahasan tentang isu utama dibalik tagar #jogjaoradidol. **Pertanyaan:** apakah ini proses pelembagaan publik dalam bentuk discourse?
3. Pada fase ketiga, lebih berkembang lagi, ada tagr jogjasat, dan selman ambyar yang merupakan representasi lain dari dibalik tagar utama. 2 tagar tersebut menunjukkan isu yang lebih spesifik, JogjaAsat tentang air, dan sleman tentang daerah Sleman. 
4. Pada fase keempat, mengercut dari segi keberagaman, dan menurun dari segi jumlah. **Pertanyaan:** apakah gerakan ini sudah sukses? namun satu hal yang pasti, pembagian fase yang saya lakukan sepertinya tidak terlalu meleset.

**user all**
**Pertanyaan:** Apakah aktornya juga berkembang? 
```{r userall, fig.cap="Figure 2: Username yang paling sering ada dalam twit", fig.align='center'}

user_terlibat <- raw_jod %>%
  group_by(fase) %>%
  unnest_tokens(user_all, user_all, to_lower = FALSE) %>%
  count(user_all, sort = TRUE) %>%
  arrange(desc(n)) %>%
  ungroup()
# viz
user_terlibat %>%
  arrange(desc(n)) %>%
  top_n(10) %>%
  ggplot(aes(x = reorder(user_all, n), y = n, fill = factor(fase))) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  facet_wrap(~fase) +
  labs(x = "Username", 
       y = "Frekuensi")
```

Aktor yang dalam konteks ini direpresentasikan oleh username juga mengalami "perkembangan". Di mana pada fase awal, tagar lebih sering digunakan oleh username @JogjaOraDidol, dan @JRX_SID lalu pada fase kedua oleh @rembugjogja dan @kilthedj. Pada fase ketiga oleh @dodoputrabangsa dan @joeyakarta. Hal ini menunjukkan bahwa tagar cenderung merepresentasikan sebuah tempat, dimana setiap orang bisa ada didalamnya. Ia tidak terikat hanya dengan salah satu aktor atau pengerak. Hal tersebut dibuktikan dengan adanya perbuahan username. 

## Konteks dan setting munculnya isu
Idealnya ini bisa dipetakan setelah partisipasi warga net diketahui. Tapi untuk kebutuhan laporan, mari lakukan saja dengan sistematika seperti ini. 

## Partisipasi Pengguna Tagar

1. Distribusi twit
2. Distribusi user
3. Distribusi fav, ret, dan fav

```{r}
partisipasi <- raw_jod[,c("date", "fav_count", "rep_count", "ret_count", "user_count")]
df1 <- partisipasi %>%
  count(date)
df2 <- partisipasi %>% 
  group_by(date) %>% 
  summarise_all(sum)

jod_dist <- as.data.frame(bind_cols(df1, df2))
jod_dist <- jod_dist %>%
  select(date, fav_count, rep_count, ret_count, user_count, tweet_count = n)
```

**plot partisipasi**

```{r, fig.align='center', fig.cap="Figure 3: Distribusi twit, user dan aktvitas pengguna tagar"}
# melt the data for ggplot using `reshape2`
jod_dist <- melt(jod_dist, id = "date")

# ploting to goem_line ggplot2
ggplot(data=jod_dist, aes(x=date, y=value, colour=variable)) +
  geom_line(show.legend = FALSE) +
  scale_x_date(labels = date_format("%Y-%m"), 
               breaks = date_breaks("6 months")) +
  facet_grid(variable~., scales="free") +
  theme(legend.position="top")
```

Apa itu? itu adalah distribusi pengguna, twit, dan aktivitas lainnya selama 1081 hari dari 07-10-2010 sampai 30-08-2017. Jika mengacu pada pembagian periode, di mana data dibagi menjadi empat, maka orang lebih banyak menggunakan tagar pada fase Emergence (mulai 2013-10-07) hingga fase Bureaucratization (berakhir pada 2014-12-31). Setelah itu, partisipasi warga net dalam penggunaan tagar mengalami penurunan.

Hal apa saja yang melatari partisipasi seperti yang ditunjukkan plot di atas? atau ada saja dibali distribusi di atas?

Untuk mendapatkan tilikan dan jawaban pertanyaan di atas, saya mengambil twit dari tanggal-tanggal, di mana orang cenderung lebih sering menggunakan tagar. Di sini, tangal tersebut diambil berdasarkan frekuensi twit yang melebih rerata per fase.  

**Rerata twit secara umum = 12 twit per hari**

### Fase 1 - Emergency
Fase Emergence berasal dari twit yang diunggah dari 2013-10-07 sampai 2013-12-31

```{r, fig.align='center', fig.cap="Figure 4: Distribusi twit dan tanggal dengan frekuensi diatas rerata pada fase Emergence", out.width=c('50%', '50%'), fig.show='hold'}

fase1_dist <- raw_jod %>%
  filter(fase == "1_Emergence") %>%
  select(date) %>%
  group_by(date) %>%
  count(date)

ggplot(fase1_dist, aes(x = date, y = n)) + 
  geom_line() + 
  labs(x = NULL, 
       y = NULL)

fase1_dist %>%
  filter(n > 58) %>%
  dplyr::arrange(desc(date)) %>%
  ggplot(aes(x = as.character(date), y = n)) + 
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(x = NULL, 
       y = NULL)
```

**Rerata fase1 = 58 twit per hari**

Terdapat 14 hari di mana tagar pada fase 1 lebih sering digunakan. 13 hari diantaranya berasal secara berutan dari tanggal 09 oktober 2013 hingga 21 oktober 2013. Sementara satu tanggal lainya dari tanggal 15 November 2013. 

### Fase 2 - Coalescence
Fase Coalescence berasal dari twit yang diunggah dari 2014-01-01 sampai 2014-06-30

```{r, fig.align='center', fig.cap="Figure 5: Distribusi twit dan tanggal dengan frekuensi diatas rerata pada fase Coalescence", out.width=c('50%', '50%'), fig.show='hold'}

fase2_dist <- raw_jod %>%
  filter(fase == "2_Coalescence") %>%
  select(date) %>%
  group_by(date) %>%
  count(date)

ggplot(fase2_dist, aes(x = date, y = n)) + 
  geom_line() + 
  labs(x = NULL, 
       y = NULL)

fase2_dist %>%
  filter(n > 58) %>%
  dplyr::arrange(desc(date)) %>%
  ggplot(aes(x = as.character(date), y = n)) + 
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(x = NULL, 
       y = NULL)
```

### Fase 3 - Bureaucratization
Periode ini berasal dari twit yang diunggah dari 2014-07-01 sampai 2014-12-31


### Fase 4 - Decline
Periode ini berasal dari twit yang diunggah dari 2015-01-01 sampai 2017-08-30

## Pembentukan opini publik: Tagar sebagai tempat diskusi

# Simpulan

